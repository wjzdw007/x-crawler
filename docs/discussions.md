# 项目讨论记录

## 2025-09-11 初始需求讨论

### 用户需求
- 写一个X的爬虫，每天爬取帖子（推荐时间线）
- 通过大语言模型总结，生成每日报告

### 技术方案讨论

#### 初步方案
用户提出基于Python + Playwright的方案：
- 使用Playwright模拟浏览器进行接口分析
- 分析完成后不再依赖浏览器，改用纯HTTP请求
- 用户协助登录获取登录态，后续复用cookie

#### 项目结构演进
1. **基础结构**：data/, reports/, crawler.py, summarizer.py, scheduler.py
2. **添加tools/**：放置探索和调试工具
3. **添加docs/**：记录讨论结论和文档

#### 简化决策
- 不考虑安全存储敏感信息（项目简化）
- 帖子数据保存为JSON文件（避免数据库复杂性）
- 使用简单的cookie文件存储登录态

### 已知问题分析
用户反馈之前遇到的技术难点：

1. **数据错误**：需要实现数据验证机制
2. **转帖原帖获取不到**：需要深入分析retweet数据结构
3. **嵌套转帖情况**：A转B，B转C的复杂情况处理
4. **图片视频地址获取失败**：需要分析media字段结构

### 重点解决策略
- 在API分析阶段重点研究上述难点
- 实现完善的数据验证和错误检测
- 建立调试工具和测试机制

### 补充需求讨论

#### 测试和自动修复需求
用户强调需要考虑：
- 自动化测试机制
- 自动修复bug的能力
- **关键问题**：防止"越改越差"的情况

#### 解决方案设计
1. **完整测试体系**：
   - 黄金数据集验证
   - 实时监控指标
   - 自动异常检测

2. **版本管理机制**：
   - 自动版本标记和性能记录
   - 性能监控和自动回退
   - 渐进式改进策略（小步快跑）

3. **智能修复系统**：
   - 多版本解析器和自动降级
   - LLM辅助错误分析和修复建议
   - A/B测试和金丝雀发布

## 决策记录
- ✅ 采用两阶段开发：Playwright分析 + 纯HTTP实现
- ✅ 简化存储方案：JSON文件存储
- ✅ 重点解决转推、媒体文件等已知难点
- ✅ 建立完整的项目结构和文档体系
- ✅ 实现完整的测试、监控和自动修复体系
- ✅ 建立版本管理和性能回退机制，防止越改越差